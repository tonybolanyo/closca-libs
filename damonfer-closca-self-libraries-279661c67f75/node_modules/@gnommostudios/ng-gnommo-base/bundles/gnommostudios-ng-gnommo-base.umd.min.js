!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs/operators"),require("@angular/common/http"),require("rxjs"),require("@angular/common")):"function"==typeof define&&define.amd?define("@gnommostudios/ng-gnommo-base",["exports","@angular/core","rxjs/operators","@angular/common/http","rxjs","@angular/common"],e):e((t.gnommostudios=t.gnommostudios||{},t.gnommostudios["ng-gnommo-base"]={}),t.ng.core,t.rxjs.operators,t.ng.common.http,t.rxjs,t.ng.common)}(this,function(t,r,o,i,n,s){"use strict";var p=function(){function t(){this.cookies={}}return t.prototype.get=function(e){if(!this.cookies[e]){var t=window.document.cookie.split("; ").filter(function(t){return t.split("=")[0]===e}).pop();if(!t)return null;this.cookies[e]=this.parse(t.split("=").slice(1).join("="))}return this.cookies[e]},t.prototype.set=function(t,e,r){this.cookies[t]=e;var o=t+"="+encodeURI(e)+"; path=/"+(r?"; expires="+r.toUTCString():"");window.document.cookie=o},t.prototype.remove=function(t){document.cookie=t+"=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;",delete this.cookies[t]},t.prototype.parse=function(t){try{return JSON.parse(decodeURI(t))}catch(e){return t}},t.decorators=[{type:r.Injectable}],t}(),u=function(){function t(){}return t.prototype.get=function(t){var e=localStorage.getItem(t);return this.parse(e)},t.prototype.set=function(t,e,r){localStorage.setItem(t,"object"==typeof e?JSON.stringify(e):e)},t.prototype.remove=function(t){localStorage[t]&&localStorage.removeItem(t)},t.prototype.parse=function(t){try{return JSON.parse(t)}catch(e){return t}},t}(),a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function c(t,e){function r(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var e=function(){function t(){}return t.prototype.get=function(t){},t.prototype.set=function(t,e,r){},t.prototype.remove=function(t){},t}(),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e}(e),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e}(e),f=function(){function t(t,e,r){this.http=t,this.url=e,this.endpoint=r,this.httpOptions={headers:new i.HttpHeaders({Accept:"*","Content-type":"application/json"})}}return t.prototype.getAll=function(t){return this.http.get(this.url+"/"+this.endpoint,this.createHttpHeaders(t)).pipe(o.map(function(t){return t}))},t.prototype.getById=function(t,e){return this.http.get(this.url+"/"+this.endpoint+"/"+t,this.createHttpHeaders(e)).pipe(o.map(function(t){return t}))},t.prototype.create=function(t,e){return this.http.post(this.url+"/"+this.endpoint,t,this.createHttpHeaders(e)).pipe(o.map(function(t){return t}))},t.prototype.update=function(t,e,r){return e._id=t,this.http.patch(this.url+"/"+this.endpoint,e,this.createHttpHeaders(r)).pipe(o.map(function(t){return t}))},t.prototype.updateComplete=function(t,e,r){return e._id=t,this.http.put(this.url+"/"+this.endpoint,e,this.createHttpHeaders(r)).pipe(o.map(function(t){return t}))},t.prototype["delete"]=function(t,e){return this.http["delete"](this.url+"/"+this.endpoint+"/"+t,this.createHttpHeaders(e)).pipe(o.map(function(t){return t}))},t.prototype.createHttpHeaders=function(e){var r=Object.assign({},this.httpOptions);return e&&Object.keys(e).forEach(function(t){r.headers=r.headers.append(t,e[t])}),r},t.prototype.httpHeadersWithoutAuth=function(e){var r={headers:new i.HttpHeaders({Accept:"*","Content-type":"application/json","X-Skip-Interceptor":""})};return e&&Object.keys(e).forEach(function(t){r.headers=r.headers.append(t,e[t])}),r},t.decorators=[{type:r.Injectable}],t.ctorParameters=function(){return[{type:i.HttpClient,decorators:[{type:r.Inject,args:[i.HttpClient]}]},{type:String,decorators:[{type:r.Inject,args:["url"]}]},{type:String,decorators:[{type:r.Inject,args:["endpoint"]}]}]},t}(),l=function(n){function t(t,e,r){var o=n.call(this,t,e,r)||this;return o.http=t,o.url=e,o.endpoint=r,o}return c(t,n),t.prototype.login=function(t,e){return this.http.post(this.url+"/"+this.endpoint+"/login",t,this.httpHeadersWithoutAuth(e)).pipe(o.map(function(t){return t}))},t.prototype.passwordRecovery=function(t,e){return this.http.post(this.url+"/"+this.endpoint+"/password-recovery",t,this.httpHeadersWithoutAuth(e)).pipe(o.map(function(t){return t}))},t.prototype.resetPassword=function(t,e,r){return this.http.post(this.url+"/"+this.endpoint+"/reset-password",{newPassword:t,hash:e},this.httpHeadersWithoutAuth(r)).pipe(o.map(function(t){return t}))},t.prototype.getCurrentUser=function(t,e){return this.http.get(this.url+"/users-me",this.createHttpHeaders(e)).pipe(o.map(function(t){return t}))},t.prototype.register=function(t,e){return this.http.post(this.url+"/"+this.endpoint+"/register",t,this.httpHeadersWithoutAuth(e)).pipe(o.map(function(t){return t}))},t.decorators=[{type:r.Injectable}],t.ctorParameters=function(){return[{type:i.HttpClient,decorators:[{type:r.Inject,args:[i.HttpClient]}]},{type:String,decorators:[{type:r.Inject,args:["url"]}]},{type:String,decorators:[{type:r.Inject,args:["endpoint"]}]}]},t}(f),y=function w(t){this.id=null,this.ttl=null,this.created=null,this.userId=null,Object.assign(this,t)},g="token_id",m="token_ttl",v="token_created",j=function(){function t(t){this.storage=t,this.token=new y,this.token.id=this.storage.get(g),this.token.ttl=this.storage.get(m),this.token.created=this.storage.get(v)}return t.prototype.getToken=function(){return this.token},t.prototype.setToken=function(t){var e=new y;e.id=t,this.persist(g,e.id,this.expiresTime()),this.persist(m,this.expiresTime(),this.expiresTime()),this.persist(v,new Date,this.expiresTime()),e.ttl=this.expiresTime(),e.created=new Date,this.token=Object.assign({},this.token,e)},t.prototype.removeToken=function(){this.storage.remove(g),this.storage.remove(m),this.storage.remove(v),this.token=new y},t.prototype.persist=function(t,e,r){try{this.storage.set(""+t,"object"==typeof e?JSON.stringify(e):e,r||null)}catch(o){}},t.prototype.expiresTime=function(){var t=new Date;return this.addDays(t,3)},t.prototype.addDays=function(t,e){var r=new Date(t);return r.setDate(r.getDate()+e),r},t.decorators=[{type:r.Injectable}],t.ctorParameters=function(){return[{type:h,decorators:[{type:r.Inject,args:[h]}]}]},t}(),H="X-Skip-Interceptor",k=function(){function t(t){this.authService=t}return t.prototype.intercept=function(t,e){var r="Bearer "+this.authService.getToken().id;if(t.headers.has(H)){var o=t.clone({headers:t.headers["delete"](H)});return e.handle(o)}var n=t.clone({headers:t.headers.set("Authorization",r)});return e.handle(n)},t.decorators=[{type:r.Injectable}],t.ctorParameters=function(){return[{type:j}]},t}(),S=function(){function t(t){this.authService=t}return t.prototype.intercept=function(t,e){var r=this;return e.handle(t).pipe(o.catchError(function(t){return 401===t.status?(r.authService.removeToken(),"Error: No tiene autorización"):t.error.message||t.statusText,n.throwError(t)}))},t.decorators=[{type:r.Injectable}],t.ctorParameters=function(){return[{type:j}]},t}(),I=function b(){},T=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[f,j,l,{provide:i.HTTP_INTERCEPTORS,useClass:k,multi:!0},{provide:i.HTTP_INTERCEPTORS,useClass:S,multi:!0},{provide:d,useClass:u},{provide:h,useClass:p}]}},e.decorators=[{type:r.NgModule,args:[{imports:[s.CommonModule,i.HttpClientModule]}]}],e}();t.CookieHandler=p,t.LocalStorageHandler=u,t.BaseStorage=e,t.WebLocalStorage=d,t.CookieStorage=h,t.BaseService=f,t.LoginBaseService=l,t.AuthService=j,t.AuthInterceptor=k,t.ErrorInterceptor=S,t.AuthToken=y,t.BaseModel=I,t.GnommoBaseModule=T,t.ɵg=k,t.ɵh=S,t.ɵb=j,t.ɵa=f,t.ɵf=l,t.ɵj=p,t.ɵi=u,t.ɵc=e,t.ɵd=h,t.ɵe=d,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=gnommostudios-ng-gnommo-base.umd.min.js.map